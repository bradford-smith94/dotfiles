# Bradford Smith
# ~/.gitconfig
# updated: 04/06/2017
#####################

[user]
    name = Bradford Smith
    #make git prompt for email before allowing commits
    useConfigOnly = true
[core]
    editor = vim
    excludesfile = ~/.gitignore
[merge]
    tool = vimdiff
[diff]
    tool = vimdiff
[difftool]
    prompt = false
[commit] #commits start with prefilled text provided in:
    template = ~/.gitmessage
[color]
    ui = auto
    branch = true
    diff = true
    interactive = true
    status = true
[color "status"]
    added = green
    changed = yellow
    untracked = red
[push]
    default = upstream
[log]
    decorate = short
[alias]
    #show aliases
    alias = "!git config --get-regexp 'alias.*' | colrm 1 6 | sed 's/[ ]/ = /' | sed 's/[ ]\\+/ /g' | fmt -t"

    authors = "shortlog -ns --no-merges"
    branches = "branch -avv"
    contributions ="!git shortlog -n -s --no-merges | colrm 1 8 | xargs -I % \
        sh -c \"echo \\\"%: \\\"; \
        git log --no-merges --use-mailmap --author=\\\"%\\\" --name-only --pretty=format:\\\"\\\" \
        | sort -u | sed '/^$/d' | wc -l | tr -d '\\n'; \
        echo -n \\\" files changed, \\\"; \
        git log --shortstat --use-mailmap --author \\\"%\\\" \
        | grep \\\"files\\? changed\\\" \
        | awk '{add+=\\$4; del+=\\$6} END {print add, \\\"insertions(+)\\\", del, \\\"deletions(-)\\\"}'\""

    #from github.com/tsu-complete/dot/blob/master/git/_gitconfig
    graph = "log --graph --pretty='%Cred%h%Creset -%C(yellow)%d%Creset %s %Cgreen(%cr) %C(bold blue)<%an>%Creset' --abbrev-commit --date=relative"
    lines = "!git grep --cached -Il '' | xargs wc -l"
    lines-authored = "!git grep --cached -Il '' | xargs -n1 git blame --line-porcelain HEAD | grep \"^author \"|sort|uniq -c|sort -nr"

    #make a .mailmap file based on the shortlog
    mkmailmap = "!git shortlog -se | awk -F'\\t' '{print $2,$3,$2,$3}' | sort > .mailmap"

    #use after git pull
    new = "!git log $1@{1}..$1@{0} \"$@\""
    newest = "log -1"

    remotes = "remote -v"
    stash-unstaged = "stash -k"
    stashes = "stash list"
    tags = "tag"
    today ="log --since=midnight"

    unpushed = "log @{u}.."
    untrack = "rm --cached"

    #for inspecting specific commits
    whatis = "show -s"

    #print git config user settings
    whoami = "!git config --get-regexp 'user.*' | colrm 1 5 | sed 's/[ ]/ = /'"

    #given a string for an author, try to figure out full name and email
    whois = "!sh -c 'git log -i -1 --pretty=\"format:%an <%ae>\" --author=\"$1\"' -"
